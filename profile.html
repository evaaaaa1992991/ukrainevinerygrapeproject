<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Особистий кабінет — Винний туризм України</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            background-image: url('фон_профіль.jpg');
        }
        
        .profile-container {
            max-width: 1000px;
            margin: 30px auto;
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 30px;
        }
        
        .profile-sidebar {
            background: var(--panel-light);
            border-radius: var(--radius);
            padding: 30px;
            border: 2px solid rgba(212, 165, 116, 0.3);
            text-align: center;
        }
        
        .profile-avatar {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid var(--wine-gold);
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 60px;
            font-weight: bold;
        }
        
        .profile-name {
            color: var(--wine-brown);
            font-size: 1.5rem;
            margin-bottom: 10px;
        }
        
        .profile-email {
            color: var(--text-medium);
            margin-bottom: 20px;
            font-size: 14px;
        }
        
        .profile-stats {
            margin: 25px 0;
            padding: 20px;
            background: rgba(212, 165, 116, 0.1);
            border-radius: 10px;
        }
        
        .stat-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(212, 165, 116, 0.3);
        }
        
        .stat-item:last-child {
            border-bottom: none;
        }
        
        .profile-menu {
            list-style: none;
            padding: 0;
            margin: 30px 0;
        }
        
        .profile-menu li {
            margin-bottom: 10px;
        }
        
        .profile-menu a {
            display: block;
            padding: 12px 20px;
            background: rgba(212, 165, 116, 0.1);
            color: var(--text-dark);
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s;
            font-weight: 600;
        }
        
        .profile-menu a:hover,
        .profile-menu a.active {
            background: linear-gradient(135deg, var(--wine-gold), var(--wine-terracotta));
            color: white;
        }
        
        .profile-content {
            background: var(--panel-light);
            border-radius: var(--radius);
            padding: 30px;
            border: 2px solid rgba(212, 165, 116, 0.3);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .stat-card {
            background: rgba(212, 165, 116, 0.1);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid rgba(212, 165, 116, 0.3);
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: var(--wine-brown);
            display: block;
        }
        
        .stat-label {
            color: var(--text-medium);
            font-size: 14px;
        }
        
        .wishlist-item {
            display: flex;
            gap: 20px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            margin-bottom: 15px;
            border: 1px solid rgba(212, 165, 116, 0.3);
            transition: all 0.3s;
        }
        
        .wishlist-item:hover {
            border-color: var(--wine-gold);
            transform: translateY(-3px);
        }
        
        .wishlist-image {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 8px;
        }
        
        .wishlist-details {
            flex: 1;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--wine-brown);
            font-weight: 600;
        }
        
        .form-control {
            width: 100%;
            padding: 12px;
            border: 2px solid rgba(212, 165, 116, 0.5);
            border-radius: 8px;
            background: white;
            color: var(--text-dark);
        }
        
        .logout-btn {
            width: 100%;
            padding: 15px;
            background: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
            border: 2px solid #e74c3c;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
        }
        
        .logout-btn:hover {
            background: #e74c3c;
            color: white;
            transform: scale(1.05);
        }
        
        @media (max-width: 768px) {
            .profile-container {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .wishlist-item {
                flex-direction: column;
            }
            
            .wishlist-image {
                width: 100%;
                height: 150px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="logo"><a href="index.html">Виноробство України</a></div>
        <nav>
            <a href="index.html">Головна</a>
                        <a href="about.html">Про сайт</a>
            <a href="regions.html">Регіони</a>
            <a href="routes.html">Маршрути</a>
            <a href="map.html">Карта</a>
                        <a href="grapes.html">Сорти</a>
            <a href="craft-wines.html">Крафтові вина</a>

            <a href="profile.html" class="active"><i class="fas fa-user-circle"></i> Кабінет</a>
        </nav>
    </header>

    <main class="container">
        <div class="profile-container" id="profile-container">
            <!-- Вміст завантажується через JavaScript -->
        </div>
    </main>

    <footer>
        © 2025–2026 — Виноробство та винний туризм України • Випускна робота Гудим Єви Олександрівни
    </footer>

    <script>
        // Завантаження користувача з localStorage
        const currentUser = JSON.parse(localStorage.getItem('currentUser'));
        
        // Перевірка авторизації
        if (!currentUser) {
            window.location.href = 'auth.html';
        }
        
        // Дані про тури
        const toursData = {
            '1': {
                title: 'Одеський винний тур "Шлях до моря"',
                image: 'одес.jpg',
                duration: '3 дні',
                price: 'від 8 500 грн/особа',
                region: 'Бессарабія'
            },
            '2': {
                title: 'Закарпатська винна стежка',
                image: 'зак2.jpg',
                duration: '4 дні',
                price: 'від 12 000 грн/особа',
                region: 'Закарпаття'
            },
            '3': {
                title: 'Подільський гастро-винний уїкенд',
                image: 'под2.jpg',
                duration: '2 дні',
                price: 'від 5 500 грн/особа',
                region: 'Поділля'
            },
            '4': {
                title: 'Бессарабське винне коло',
                image: 'бес2.jpg',
                duration: '5 днів',
                price: 'від 15 000 грн/особа',
                region: 'Бессарабія'
            },
            '5': {
                title: 'Львівсько-винний експрес',
                image: 'льв.jpg',
                duration: '3 дні',
                price: 'від 7 800 грн/особа',
                region: 'Західна Україна'
            },
            '6': {
                title: 'Винна дегустація під Києвом',
                image: 'київ.jpg',
                duration: '1 день',
                price: 'від 2 500 грн/особа',
                region: 'Центральна Україна'
            }
        };
        
        // Завантаження профілю
        function loadProfile() {
            const users = JSON.parse(localStorage.getItem('wineTourismUsers')) || [];
            const user = users.find(u => u.id === currentUser.id) || currentUser;
            const wishlist = user.wishlist || [];
            const bookedTours = user.bookedTours || [];
            
            // HTML для профілю
            const profileHTML = `
                <div class="profile-sidebar">
                    <div class="profile-avatar" style="background-color: ${user.avatarColor || '#8b4513'}">
                        ${user.avatarLetter || user.name.charAt(0).toUpperCase()}
                    </div>
                    <h2 class="profile-name">${user.name}</h2>
                    <p class="profile-email">${user.email}</p>
                    
                    <div class="profile-stats">
                        <div class="stat-item">
                            <span>Реєстрація:</span>
                            <strong>${formatDate(user.registeredAt)}</strong>
                        </div>
                        <div class="stat-item">
                            <span>Останній вхід:</span>
                            <strong>${formatDate(user.lastLogin)}</strong>
                        </div>
                        <div class="stat-item">
                            <span>Бажане:</span>
                            <strong>${wishlist.length} турів</strong>
                        </div>
                    </div>
                    
                    <ul class="profile-menu">
                        <li><a href="#overview" class="active" onclick="switchTab('overview')"><i class="fas fa-home"></i> Огляд</a></li>
                        <li><a href="#wishlist" onclick="switchTab('wishlist')"><i class="fas fa-heart"></i> Бажане (${wishlist.length})</a></li>
                        <li><a href="#settings" onclick="switchTab('settings')"><i class="fas fa-cog"></i> Налаштування</a></li>
                    </ul>
                    
                    <button class="logout-btn" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> Вийти
                    </button>
                    <button 
                    type="button" 
                    class="logout-btn"
                    style="background: rgba(231, 76, 60, 0.08);"
                    onclick="deleteAccount()"
>
    <i class="fas fa-user-slash"></i> Видалити акаунт
</button>
                </div>

                <div class="profile-content">
                    <!-- Вкладка Огляд -->
                    <div id="overview-tab" class="tab-content active">
                        <h2><i class="fas fa-chart-line"></i> Статистика</h2>
                        
                        <div class="stats-grid">
                            <div class="stat-card">
                                <span class="stat-number">${wishlist.length}</span>
                                <span class="stat-label">Збережених турів</span>
                            </div>
                            <div class="stat-card">
                                <span class="stat-number">${countUniqueRegions(wishlist)}</span>
                                <span class="stat-label">Винних регіонів</span>
                            </div>
                            <div class="stat-card">
                                <span class="stat-number">${calculateTotalDays(wishlist)}</span>
                                <span class="stat-label">Днів подорожей</span>
                            </div>
                        </div>                    
                        
                        ${user.preferences && (user.preferences.region || user.preferences.wineType) ? `
                            <div style="background: rgba(212, 165, 116, 0.1); padding: 20px; border-radius: 10px; margin-top: 20px;">
                                <h3>Ваші вподобання:</h3>
                                ${user.preferences.region ? `<p><strong>Регіон:</strong> ${user.preferences.region}</p>` : ''}
                                ${user.preferences.wineType ? `<p><strong>Тип вина:</strong> ${user.preferences.wineType}</p>` : ''}
                                ${user.preferences.budget ? `<p><strong>Бюджет:</strong> ${user.preferences.budget}</p>` : ''}
                            </div>
                        ` : ''}
                    </div>
                    
                    <!-- Вкладка Бажане -->
                    <div id="wishlist-tab" class="tab-content">
                        <h2><i class="fas fa-heart"></i> Моє бажане</h2>
                        
                        ${wishlist.length > 0 ? 
                            wishlist.map(item => {
                                const tour = toursData[item.id] || {};
                                return `
                                    <div class="wishlist-item">
                                        <img src="${tour.image || 'placeholder.jpg'}" alt="${tour.title}" class="wishlist-image">
                                        <div class="wishlist-details">
                                            <h3 style="margin: 0 0 10px 0; color: var(--wine-brown);">${tour.title || 'Тур не знайдено'}</h3>
                                            <div style="display: flex; gap: 15px; margin-bottom: 10px; font-size: 14px; color: var(--text-medium);">
                                                <span><i class="fas fa-clock"></i> ${tour.duration || 'Н/Д'}</span>
                                                <span><i class="fas fa-tag"></i> ${tour.price || 'Н/Д'}</span>
                                                <span><i class="fas fa-map-marker-alt"></i> ${tour.region || 'Н/Д'}</span>
                                            </div>
                                            <div>
                                                </button>
                                                <button class="pill" style="padding: 8px 15px; background: rgba(231, 76, 60, 0.1); color: #e74c3c; border-color: #e74c3c; margin-left: 10px;" 
                                                        onclick="removeFromWishlist('${item.id}')">
                                                    <i class="fas fa-trash"></i> Видалити
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                `;
                            }).join('') 
                            : 
                            '<div style="text-align: center; padding: 40px; color: var(--text-medium);">' +
                            '<i class="fas fa-heart" style="font-size: 3rem; opacity: 0.3; margin-bottom: 20px;"></i>' +
                            '<h3>Список бажаного порожній</h3>' +
                            '<p>Додайте тури до бажаного, щоб планувати ваші майбутні подорожі</p>' +
                            '<a href="routes.html" class="pill" style="margin-top: 20px; display: inline-block;">Переглянути тури</a>' +
                            '</div>'
                        }
                    </div>
                    
                    
                    <!-- Вкладка Налаштування -->
                    <div id="settings-tab" class="tab-content">
                        <h2><i class="fas fa-cog"></i> Налаштування профілю</h2>
                        
                        <form id="profile-form" onsubmit="updateProfile(event)">
                            <div class="form-group">
                                <label for="preferred-region">Улюблений винний регіон</label>
                                <select id="preferred-region" class="form-control">
                                    <option value="">Не обрано</option>
                                    <option value="Бессарабія" ${user.preferences && user.preferences.region === 'Бессарабія' ? 'selected' : ''}>Бессарабія</option>
                                    <option value="Закарпаття" ${user.preferences && user.preferences.region === 'Закарпаття' ? 'selected' : ''}>Закарпаття</option>
                                    <option value="Поділля" ${user.preferences && user.preferences.region === 'Поділля' ? 'selected' : ''}>Поділля</option>
                                    <option value="Західна Україна" ${user.preferences && user.preferences.region === 'Західна Україна' ? 'selected' : ''}>Західна Україна</option>
                                    <option value="Центральна Україна" ${user.preferences && user.preferences.region === 'Центральна Україна' ? 'selected' : ''}>Центральна Україна</option>
                                    <option value="Причорномор'я" ${user.preferences && user.preferences.region === 'Причорномор\'я' ? 'selected' : ''}>Причорномор'я</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="wine-type">Улюблений тип вина</label>
                                <select id="wine-type" class="form-control">
                                    <option value="">Не обрано</option>
                                    <option value="Біле" ${user.preferences && user.preferences.wineType === 'Біле' ? 'selected' : ''}>Біле</option>
                                    <option value="Червоне" ${user.preferences && user.preferences.wineType === 'Червоне' ? 'selected' : ''}>Червоне</option>
                                    <option value="Рожеве" ${user.preferences && user.preferences.wineType === 'Рожеве' ? 'selected' : ''}>Рожеве</option>
                                    <option value="Ігристе" ${user.preferences && user.preferences.wineType === 'Ігристе' ? 'selected' : ''}>Ігристе</option>
                                    <option value="Помаранчеве" ${user.preferences && user.preferences.wineType === 'Помаранчеве' ? 'selected' : ''}>Помаранчеве</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="budget">Бюджет подорожей</label>
                                <select id="budget" class="form-control">
                                    <option value="">Не обрано</option>
                                    <option value="До 5000 грн" ${user.preferences && user.preferences.budget === 'До 5000 грн' ? 'selected' : ''}>До 5000 грн</option>
                                    <option value="5000-10000 грн" ${user.preferences && user.preferences.budget === '5000-10000 грн' ? 'selected' : ''}>5000-10000 грн</option>
                                    <option value="10000-20000 грн" ${user.preferences && user.preferences.budget === '10000-20000 грн' ? 'selected' : ''}>10000-20000 грн</option>
                                    <option value="Понад 20000 грн" ${user.preferences && user.preferences.budget === 'Понад 20000 грн' ? 'selected' : ''}>Понад 20000 грн</option>
                                </select>
                            </div>
                            
                            <button type="submit" class="pill" style="padding: 12px 30px;">
                                <i class="fas fa-save"></i> Зберегти зміни
                            </button>
                        </form>
                    </div>
                </div>
            `;
            
            document.getElementById('profile-container').innerHTML = profileHTML;
        }
        
        // ========== ФУНКЦІЇ ==========
        
        function formatDate(dateString) {
            if (!dateString) return 'Н/Д';
            const date = new Date(dateString);
            return date.toLocaleDateString('uk-UA');
        }
        
        function switchTab(tabId) {
            // Приховуємо всі вкладки
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Видаляємо активний клас з меню
            const menuLinks = document.querySelectorAll('.profile-menu a');
            if (menuLinks.length > 0) {
                menuLinks.forEach(link => {
                    link.classList.remove('active');
                });
                
                // Додаємо активний клас до відповідного посилання
                const activeLink = document.querySelector(`.profile-menu a[href="#${tabId}"]`);
                if (activeLink) {
                    activeLink.classList.add('active');
                }
            }
            
            // Показуємо вибрану вкладку
            const tabElement = document.getElementById(`${tabId}-tab`);
            if (tabElement) {
                tabElement.classList.add('active');
            }
        }
        
        function countUniqueRegions(wishlist) {
            const regions = new Set();
            wishlist.forEach(item => {
                const tour = toursData[item.id];
                if (tour && tour.region) {
                    regions.add(tour.region);
                }
            });
            return regions.size;
        }
        
        function calculateTotalDays(wishlist) {
            let total = 0;
            wishlist.forEach(item => {
                const tour = toursData[item.id];
                if (tour && tour.duration) {
                    const daysMatch = tour.duration.match(/\d+/);
                    if (daysMatch) {
                        total += parseInt(daysMatch[0]);
                    }
                }
            });
            return total;
        }
        
        function updateProfile(event) {
            event.preventDefault();
            
            const users = JSON.parse(localStorage.getItem('wineTourismUsers')) || [];
            const userIndex = users.findIndex(u => u.id === currentUser.id);
            
            if (userIndex === -1) return;
            
            users[userIndex].preferences = {
                region: document.getElementById('preferred-region').value,
                wineType: document.getElementById('wine-type').value,
                budget: document.getElementById('budget').value
            };
            
            localStorage.setItem('wineTourismUsers', JSON.stringify(users));
            localStorage.setItem('currentUser', JSON.stringify(users[userIndex]));
            
            alert('Налаштування збережено!');
            loadProfile();
        }
        
        function removeFromWishlist(tourId) {
            if (confirm('Видалити цей тур з бажаного?')) {
                const users = JSON.parse(localStorage.getItem('wineTourismUsers')) || [];
                const userIndex = users.findIndex(u => u.id === currentUser.id);
                
                if (userIndex !== -1) {
                    users[userIndex].wishlist = users[userIndex].wishlist.filter(item => item.id !== tourId);
                    
                    localStorage.setItem('wineTourismUsers', JSON.stringify(users));
                    localStorage.setItem('currentUser', JSON.stringify(users[userIndex]));
                    
                    loadProfile();
                    showNotification('Тур видалено з бажаного', 'success');
                }
            }
        }
        
        function bookTour(tourId) {
            const tour = toursData[tourId];
            if (!tour) {
                showNotification('Інформація про тур не знайдена', 'error');
                return;
            }
            
            // Зберігаємо дані туру для форми бронювання
            sessionStorage.setItem('bookingTourId', tourId);
            sessionStorage.setItem('bookingTourTitle', tour.title);
            
            // Перенаправляємо на сторінку бронювання
            window.location.href = 'routes.html#booking-form';
        }
        
        function logout() {
            // Видаляємо дані про поточного користувача
            localStorage.removeItem('currentUser');
            window.location.href = 'index.html';
        }
        function deleteAccount() {
    const confirmDelete = confirm(
        'Ви впевнені, що хочете повністю видалити акаунт?\n\n' +
        'Усі дані (профіль, бажане, налаштування) буде втрачено без можливості відновлення.'
    );

    if (!confirmDelete) return;

    let users = JSON.parse(localStorage.getItem('wineTourismUsers')) || [];

    // видаляємо користувача 
    users = users.filter(u => u.id !== currentUser.id);

    // зберігаємо оновлений список
    localStorage.setItem('wineTourismUsers', JSON.stringify(users));

    // прибираємо поточного 
    localStorage.removeItem('currentUser');

    alert('Ваш акаунт успішно видалено.');

    // перекидаємо на головну 
    window.location.href = 'index.html';
    }
        function showNotification(message, type = 'info') {
            // Створюємо елемент сповіщення
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 25px;
                border-radius: 8px;
                color: white;
                font-weight: 600;
                z-index: 1000;
                animation: slideIn 0.3s ease;
                max-width: 300px;
                box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            `;
            
            // Встановлюємо колір в залежності від типу
            switch(type) {
                case 'success':
                    notification.style.background = 'linear-gradient(135deg, #27ae60, #2ecc71)';
                    break;
                case 'error':
                    notification.style.background = 'linear-gradient(135deg, #c0392b, #e74c3c)';
                    break;
                default:
                    notification.style.background = 'linear-gradient(135deg, var(--wine-gold), var(--wine-terracotta))';
            }
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // Автоматично видаляємо сповіщення через 3 секунди
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
            
            // Додаємо CSS анімації
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                @keyframes slideOut {
                    from { transform: translateX(0); opacity: 1; }
                    to { transform: translateX(100%); opacity: 0; }
                }
            `;
            document.head.appendChild(style);
        }
        
        // Завантажуємо профіль при завантаженні сторінки
        document.addEventListener('DOMContentLoaded', loadProfile);
    </script>
</body>

</html>


