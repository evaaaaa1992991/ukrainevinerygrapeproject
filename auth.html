<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Авторизація — Виноробство України</title>

    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        .auth-container {
            min-height: 70vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 40px 20px;
        }

        .auth-wrapper {
            display: flex;
            gap: 40px;
            width: 100%;
            max-width: 900px;
            justify-content: center;
        }
        .auth-page-header {
        min-height: 70vh;
        display: flex;
        align-items: center;
        padding: 40px 20px;
        }

        .auth-block {
            background: #ffffff;
            padding: 25px;
            border-radius: 16px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            width: 100%;
            max-width: 380px;
        }

        .auth-title {
            text-align: center;
            margin-bottom: 20px;
            color: #8b4513;
        }

        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .form-group {
            width: 100%;
        }

        .form-control {
            width: 100%;
        }

        .auth-btn {
            margin-top: 10px;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            color: #fff;
            font-weight: 600;
            z-index: 1000;
            display: none;
        }

        .notification.success {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
        }

        .notification.error {
            background: linear-gradient(135deg, #c0392b, #e74c3c);
        }

        @media (max-width: 768px) {
            .auth-wrapper {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>

<body>

<header>
    <div class="logo"><a href="index.html">Виноробство України</a></div>
    <nav>
        <a href="index.html">Головна</a>
        <a href="about.html">Про сайт</a>
        <a href="regions.html">Регіони</a>
        <a href="routes.html">Маршрути</a>
        <a href="map.html">Карта</a>
        <a href="grapes.html">Сорти</a>
        <a href="craft-wines.html">Крафтові вина</a>
        <a href="auth.html" class="active"><i class="fas fa-user"></i> Вхід</a>
    </nav>
</header>

<main class="auth-container">
    <div id="notification" class="notification"></div>
    <div class="auth-layout">

        <div class="auth-info">
            <h1><i></i> Особистий кабінет</h1>
            <p>
                Увійдіть або зареєструйтесь для доступу до повного
                функціоналу сервісу виноробства та винного туризму України.
            </p>
        </div>

        <div class="auth-wrapper">

        <div class="auth-block">
            <h2 class="auth-title">
                <i></i> Вхід
            </h2>

            <form id="login-form" class="auth-form">
                <div class="form-group">
                    <label><i class="fas fa-envelope"></i> Електронна пошта</label>
                    <input type="email" id="login-email" class="form-control" placeholder="your@email.com" required>
                    <div class="form-error" id="login-email-error"></div>
                </div>

                <div class="form-group password-toggle">
                    <label for="login-password"><i class="fas fa-lock"></i> Пароль</label>
                    <input type="password" id="login-password" class="form-control" placeholder="••••••••" required>
                    <button type="button" class="toggle-btn" data-toggle="login-password">
                        <i class="fas fa-eye"></i>
                    </button>
                    <div class="form-error" id="login-password-error"></div>
                </div>

                <div class="form-check">
                    <input type="checkbox" id="remember-me">
                    <label for="remember-me">Запам'ятати мене</label>
                </div>

                <button type="submit" class="auth-btn">
                    <i></i> Увійти
                </button>
            </form>
        </div>

        <div class="auth-block">
            <h2 class="auth-title">
                <i></i> Реєстрація
            </h2>
            <form id="register-form" class="auth-form">
                <div class="form-group">
                    <label><i class="fas fa-user"></i> Імʼя та прізвище</label>
                    <input type="text" id="register-name" class="form-control" placeholder="Тарас Шевченко" required>
                    <div class="form-error" id="register-name-error"></div>
                </div>

                <div class="form-group">
                    <label><i class="fas fa-envelope"></i> Електронна пошта</label>
                    <input type="email" id="register-email" class="form-control" placeholder="your@email.com" required>
                    <div class="form-error" id="register-email-error"></div>
                </div>

                                <div class="form-group password-toggle">
                    <label for="register-password"><i class="fas fa-lock"></i> Пароль</label>
                    <input type="password" id="register-password" class="form-control" placeholder="••••••••" required>
                    <button type="button" class="toggle-btn" data-toggle="register-password">
                        <i class="fas fa-eye"></i>
                    </button>
                    <div class="form-error" id="register-password-error"></div>
                </div>

                <div class="form-group">
                    <label><i class="fas fa-lock"></i> Підтвердіть пароль</label>
                    <input type="password" id="register-confirm" class="form-control" required>
                    <div class="form-error" id="register-confirm-error"></div>
                </div>

                <div class="form-check">
                    <input type="checkbox" id="terms" required>
                    <label for="terms">Реєстрацію підтверджую</label>
                </div>
                
                <button type="submit" class="auth-btn">
                    <i></i> Зареєструватись
                </button>
            </form>
        </div>

    </div>
</main>

<footer>
    © 2025–2026 — Виноробство та винний туризм України • Випускна робота Гудим Єви Олександрівни
</footer>

    <script>
    	
        class UserDatabase {
            constructor() {
                this.users = this.loadUsers();
                this.currentUser = this.loadCurrentUser();
            }
            
            loadUsers() {
                try {
                    const users = localStorage.getItem('wineTourismUsers');
                    return users ? JSON.parse(users) : [];
                } catch (error) {
                    console.error('Помилка завантаження користувачів:', error);
                    return [];
                }
            }
            
            loadCurrentUser() {
                try {
                    const user = localStorage.getItem('currentUser');
                    return user ? JSON.parse(user) : null;
                } catch (error) {
                    console.error('Помилка завантаження користувача:', error);
                    return null;
                }
            }
            
            saveUsers() {
                try {
                    localStorage.setItem('wineTourismUsers', JSON.stringify(this.users));
                } catch (error) {
                    console.error('Помилка збереження користувачів:', error);
                }
            }
            
            saveCurrentUser() {
                try {
                    localStorage.setItem('currentUser', JSON.stringify(this.currentUser));
                } catch (error) {
                    console.error('Помилка збереження користувача:', error);
                }
            }
            
            register(name, email, password) {
                // Перевірка наявності користувача
                if (this.users.some(user => user.email === email)) {
                    return { 
                        success: false, 
                        message: 'Користувач з такою поштою вже існує' 
                    };
                }
                
                const hashedPassword = this.hashPassword(password);
                
                const newUser = {
                    id: Date.now().toString(),
                    name: name.trim(),
                    email: email.toLowerCase().trim(),
                    password: hashedPassword,
                    registeredAt: new Date().toISOString(),
                    lastLogin: new Date().toISOString(),
                    wishlist: [],
                    bookedTours: [],
                    preferences: {
                        region: '',
                        wineType: '',
                        budget: ''
                    },
                    avatarColor: this.generateAvatarColor(),
                    avatarLetter: name.trim().charAt(0).toUpperCase()
                };
                
                this.users.push(newUser);
                this.currentUser = newUser;
                
                this.saveUsers();
                this.saveCurrentUser();
                
                return { 
                    success: true, 
                    message: 'Реєстрація успішна!', 
                    user: newUser 
                };
            }
            
            login(email, password) {
                const user = this.users.find(user => 
                    user.email === email.toLowerCase().trim()
                );
                
                if (!user) {
                    return { 
                        success: false, 
                        message: 'Користувача з такою поштою не знайдено' 
                    };
                }
                
                const hashedPassword = this.hashPassword(password);
                if (user.password !== hashedPassword) {
                    return { 
                        success: false, 
                        message: 'Неправильний пароль' 
                    };
                }
                
                user.lastLogin = new Date().toISOString();
                this.currentUser = user;
                
                this.saveUsers();
                this.saveCurrentUser();
                
                return { 
                    success: true, 
                    message: 'Вхід успішний!', 
                    user: user 
                };
            }
            
            logout() {
                this.currentUser = null;
                this.saveCurrentUser();
                return { success: true, message: 'Ви вийшли з системи' };
            }
            
            updateProfile(userId, updates) {
                const userIndex = this.users.findIndex(user => user.id === userId);
                
                if (userIndex === -1) {
                    return { success: false, message: 'Користувача не знайдено' };
                }
                
                this.users[userIndex] = { ...this.users[userIndex], ...updates };
                
                if (this.currentUser && this.currentUser.id === userId) {
                    this.currentUser = this.users[userIndex];
                    this.saveCurrentUser();
                }
                
                this.saveUsers();
                
                return { 
                    success: true, 
                    message: 'Профіль оновлено', 
                    user: this.users[userIndex] 
                };
            }
            
            addToWishlist(userId, tourId, tourData) {
                const userIndex = this.users.findIndex(user => user.id === userId);
                
                if (userIndex === -1) {
                    return { success: false, message: 'Користувача не знайдено' };
                }
                
                const exists = this.users[userIndex].wishlist.some(item => item.id === tourId);
                
                if (exists) {
                    return { 
                        success: false, 
                        message: 'Цей тур вже у вашому списку бажаного' 
                    };
                }
                
                this.users[userIndex].wishlist.push({
                    id: tourId,
                    ...tourData,
                    addedAt: new Date().toISOString()
                });
                
                if (this.currentUser && this.currentUser.id === userId) {
                    this.currentUser.wishlist = this.users[userIndex].wishlist;
                    this.saveCurrentUser();
                }
                
                this.saveUsers();
                
                return { 
                    success: true, 
                    message: 'Тур додано до бажаного' 
                };
            }
            
            removeFromWishlist(userId, tourId) {
                const userIndex = this.users.findIndex(user => user.id === userId);
                
                if (userIndex === -1) {
                    return { success: false, message: 'Користувача не знайдено' };
                }
                
                this.users[userIndex].wishlist = this.users[userIndex].wishlist.filter(
                    item => item.id !== tourId
                );
                
                if (this.currentUser && this.currentUser.id === userId) {
                    this.currentUser.wishlist = this.users[userIndex].wishlist;
                    this.saveCurrentUser();
                }
                
                this.saveUsers();
                
                return { 
                    success: true, 
                    message: 'Тур видалено з бажаного' 
                };
            }
            
            hashPassword(password) {
                return btoa(password + 'wine_tourism_salt');
            }
            
            generateAvatarColor() {
                const colors = [
                    '#8b4513', '#a0522d', '#d4a574', '#b5651d',
                    '#9D4EDD', '#FF6B6B', '#06D6A0', '#118AB2'
                ];
                return colors[Math.floor(Math.random() * colors.length)];
            }
            
            isAuthenticated() {
                return this.currentUser !== null;
            }
            getCurrentUser() {
                return this.currentUser;
            }
        }
        

        const userDB = new UserDatabase();
    
        document.addEventListener('DOMContentLoaded', function() {
            if (userDB.isAuthenticated() && window.location.pathname.includes('auth.html')) {
                showNotification('Ви вже авторизовані!', 'success');
                setTimeout(() => {
                    window.location.href = 'index.html';
                }, 1500);
                return;
            }
            
            setupTabs();      
            setupPasswordToggle();          
            setupLoginForm();     
            setupRegisterForm();
            setupRealTimeValidation();
        });
        
        function setupTabs() {
            document.querySelectorAll('.auth-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    document.querySelectorAll('.auth-form').forEach(form => form.classList.remove('active'));
                    document.getElementById(`${tabId}-form`).classList.add('active');
                });
            });
        }
        
        function setupPasswordToggle() {
            document.querySelectorAll('.toggle-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const targetId = this.getAttribute('data-toggle');
                    const input = document.getElementById(targetId);
                    const icon = this.querySelector('i');
                    
                    if (input.type === 'password') {
                        input.type = 'text';
                        icon.classList.remove('fa-eye');
                        icon.classList.add('fa-eye-slash');
                    } else {
                        input.type = 'password';
                        icon.classList.remove('fa-eye-slash');
                        icon.classList.add('fa-eye');
                    }
                });
            });
        }
        
        function setupLoginForm() {
            const loginForm = document.getElementById('login-form');
            
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const email = document.getElementById('login-email').value.trim();
                const password = document.getElementById('login-password').value;
                
                if (!validateEmail(email)) {
                    showFormError('login-email-error', 'Будь ласка, введіть коректну email адресу');
                    return;
                }
                
                if (password.length < 6) {
                    showFormError('login-password-error', 'Пароль має містити мінімум 6 символів');
                    return;
                }
                
                const result = userDB.login(email, password);
                
                if (result.success) {
                    showNotification('Вхід успішний! Перенаправляємо...', 'success');
                    
                    const rememberMe = document.getElementById('remember-me').checked;
                    if (rememberMe) {
                        localStorage.setItem('rememberedUser', email);
                    }
                    
                    setTimeout(() => {
                        window.location.href = 'index.html';
                    }, 1500);
                } else {
                    showFormError('login-password-error', result.message);
                }
            });
        }
        
        function setupRegisterForm() {
            const registerForm = document.getElementById('register-form');
            
            registerForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const name = document.getElementById('register-name').value.trim();
                const email = document.getElementById('register-email').value.trim();
                const password = document.getElementById('register-password').value;
                const confirm = document.getElementById('register-confirm').value;
                
                // Валідація
                if (!validateName(name)) {
                    showFormError('register-name-error', 'Ім\'я має містити мінімум 2 символи');
                    return;
                }
                
                if (!validateEmail(email)) {
                    showFormError('register-email-error', 'Будь ласка, введіть коректну email адресу');
                    return;
                }
                
                if (!validatePassword(password)) {
                    showFormError('register-password-error', 'Пароль має містити мінімум 6 символів');
                    return;
                }
                
                if (password !== confirm) {
                    showFormError('register-confirm-error', 'Паролі не співпадають');
                    return;
                }
                
                if (!document.getElementById('terms').checked) {
                    showFormError('register-confirm-error', 'Необхідно підтвердити реєстрацію');
                    return;
                }
                
                const result = userDB.register(name, email, password);
                
                if (result.success) {
                    showNotification('Реєстрація успішна! Перенаправляємо...', 'success');
                    
                    setTimeout(() => {
                        window.location.href = 'index.html';
                    }, 1500);
                } else {
                    showFormError('register-email-error', result.message);
                }
            });
        }
        
        function setupRealTimeValidation() {
            document.getElementById('register-email').addEventListener('blur', function() {
                const email = this.value.trim();
                if (email && !validateEmail(email)) {
                    showFormError('register-email-error', 'Будь ласка, введіть коректну email адресу');
                } else {
                    hideFormError('register-email-error');
                }
            });
            
            document.getElementById('register-password').addEventListener('input', function() {
                if (this.value.length > 0 && this.value.length < 6) {
                    showFormError('register-password-error', 'Пароль має містити принаймні 6 символів');
                } else {
                    hideFormError('register-password-error');
                }
            });
            
            document.getElementById('register-confirm').addEventListener('input', function() {
                const password = document.getElementById('register-password').value;
                
                if (this.value !== password) {
                    showFormError('register-confirm-error', 'Паролі не співпадають');
                } else {
                    hideFormError('register-confirm-error');
                }
            });
        }
        
        
        function validateEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }
        
        function validateName(name) {
            return name.length >= 2;
        }
        
        function validatePassword(password) {
            return password.length >= 6;
        }
        
        function showFormError(elementId, message) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.style.display = 'block';
        }
        
        function hideFormError(elementId) {
            const element = document.getElementById(elementId);
            element.style.display = 'none';
        }
        
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }
        
        window.logoutUser = function() {
            userDB.logout();
            showNotification('Ви вийшли з системи', 'success');
            setTimeout(() => {
                window.location.href = 'index.html';
            }, 1000);
        };
        
        window.checkAuth = function() {
            return userDB.isAuthenticated();
        };
        
        window.getCurrentUser = function() {
            return userDB.getCurrentUser();
        };
        
        window.addToWishlist = function(tourId, tourData) {
            if (!userDB.isAuthenticated()) {
                showNotification('Будь ласка, увійдіть в систему', 'error');
                return false;
            }
            
            const result = userDB.addToWishlist(
                userDB.currentUser.id,
                tourId,
                tourData
            );
            
            if (result.success) {
                showNotification(result.message, 'success');
            } else {
                showNotification(result.message, 'error');
            }
            
            return result.success;
        };
        
        window.removeFromWishlist = function(tourId) {
            if (!userDB.isAuthenticated()) {
                return false;
            }
            
            return userDB.removeFromWishlist(userDB.currentUser.id, tourId);
        };
        
        window.getWishlist = function() {
            if (!userDB.isAuthenticated()) {
                return [];
            }
            
            return userDB.currentUser.wishlist || [];
        };
    </script>
</body>

</html>



















